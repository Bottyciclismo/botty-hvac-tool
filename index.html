<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>BOTTY HVAC TOOL</title>

<style>
body {
  background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
  font-family: 'Segoe UI', sans-serif;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
  color: white;
}

.container {
  background: #0d1b2a;
  width: 420px;
  padding: 25px;
  border-radius: 30px;
  box-shadow: 0 25px 50px rgba(0,0,0,0.6);
  border: 3px solid #1b263b;
}

.brand {
  text-align: center;
  font-weight: bold;
  font-size: 18px;
  letter-spacing: 2px;
  margin-bottom: 10px;
  color: #4cc9f0;
}

.display {
  background: #001d3d;
  font-size: 52px;
  text-align: right;
  padding: 20px;
  border-radius: 15px;
  margin-bottom: 15px;
  box-shadow: inset 0 0 15px #000;
  transition: 0.3s;
}

.bar-container {
  background: #1b263b;
  height: 12px;
  border-radius: 10px;
  margin-bottom: 20px;
  overflow: hidden;
}

.bar {
  height: 100%;
  width: 0%;
  background: #4cc9f0;
  transition: 0.4s;
}

label {
  font-size: 13px;
  color: #a9d6e5;
}

select, input {
  width: 100%;
  padding: 10px;
  margin: 8px 0;
  border-radius: 15px;
  border: none;
  background: #1b263b;
  color: white;
}

button {
  width: 100%;
  padding: 14px;
  border-radius: 25px;
  border: none;
  background: #4cc9f0;
  color: #001d3d;
  font-weight: bold;
  font-size: 16px;
  margin-top: 15px;
  cursor: pointer;
  transition: 0.2s;
}

button:hover {
  background: #90e0ef;
  transform: scale(1.05);
}

.footer {
  text-align: center;
  font-size: 11px;
  margin-top: 15px;
  color: #89c2d9;
}
</style>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#0f2027">
</head>
<script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('service-worker.js');
}
</script>

<body>

<div class="container">

<div class="brand">BOTTY HVAC TOOL ❄️</div>

<div class="display" id="display">0.00 °C</div>

<div class="bar-container">
  <div class="bar" id="bar"></div>
</div>

<label>Tipo de Sonda</label>
<select id="tipo">
  <option value="NTC_1000">NTC 1K</option>
  <option value="NTC_10000">NTC 10K</option>
  <option value="NTC_25000">NTC 25K</option>
  <option value="PTC_1000">PTC 1K</option>
  <option value="PTC_10000">PTC 10K</option>
  <option value="PTC_25000">PTC 25K</option>
</select>

<label>Resistencia medida (Ω)</label>
<input type="number" id="resistencia" placeholder="Ej: 589">

<label>Beta (solo NTC - default 3435)</label>
<input type="number" id="beta" value="3435">

<button onclick="calcular()">MEDIR</button>

<div class="footer">
Modo Secador Frigorífico • Zona normal 2°C – 45°C
</div>

</div>

<script>

function calcNTC(R, R0, beta){
    let T0 = 298.15;
    let tempK = 1 / ((1/T0) + (1/beta) * Math.log(R/R0));
    return tempK - 273.15;
}

function calcPTC(R, R0){
    let alpha = 0.00385;
    return (R - R0) / (R0 * alpha);
}

function calcular(){

    let tipo = document.getElementById("tipo").value;
    let R = parseFloat(document.getElementById("resistencia").value);
    let beta = parseFloat(document.getElementById("beta").value);
    let display = document.getElementById("display");
    let bar = document.getElementById("bar");

    if (!R || R <= 0){
        display.innerHTML = "ERROR";
        display.style.color = "#ff4d6d";
        return;
    }

    let R0 = parseInt(tipo.split("_")[1]);
    let tempC;

    if (tipo.includes("NTC")){
        tempC = calcNTC(R, R0, beta);
    } else {
        tempC = calcPTC(R, R0);
    }

    display.innerHTML = tempC.toFixed(2) + " °C";

    // Barra proporcional -20 a 100°C
    let porcentaje = ((tempC + 20) / 120) * 100;
    porcentaje = Math.max(0, Math.min(100, porcentaje));
    bar.style.width = porcentaje + "%";

    // Colores inteligentes
    if (tempC < 2){
        display.style.color = "#00b4d8";
        bar.style.background = "#00b4d8";
    }
    else if (tempC >= 2 && tempC <= 45){
        display.style.color = "#4cc9f0";
        bar.style.background = "#4cc9f0";
    }
    else if (tempC > 45){
        display.style.color = "#ff6b6b";
        bar.style.background = "#ff6b6b";
    }

    if (tempC < -40 || tempC > 120){
        display.innerHTML = "FUERA RANGO";
        display.style.color = "#ff4d6d";
        bar.style.width = "0%";
    }
}

</script>

</body>
</html>
