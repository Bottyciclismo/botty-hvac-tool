<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BOTTY TECH TOOLBOX</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#0f2027">

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body {
  background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
  font-family: 'Segoe UI', sans-serif;
  margin:0;
  padding-top:70px;
  display:flex;
  justify-content:center;
  min-height:100vh;
  color:white;
}

.topmenu{
  position:fixed;
  top:10px;
  left:50%;
  transform:translateX(-50%);
  display:flex;
  gap:10px;
  z-index:999;
}

.topmenu button{
  padding:8px 15px;
  border:none;
  border-radius:10px;
  font-weight:bold;
  cursor:pointer;
}

.btn-sondas{ background:#4cc9f0; }
.btn-comp{ background:#f2c200; }

.container { 
  width:95%;
  max-width:600px;
}

.module{ display:none; }
.active{ display:block; }

.brand {
  text-align: center;
  font-weight: bold;
  font-size: 18px;
  letter-spacing: 2px;
  margin-bottom: 10px;
  color: #4cc9f0;
}

.display {
  background: #001d3d;
  font-size: 65px;
  text-align: right;
  padding: 20px;
  border-radius: 15px;
  margin-bottom: 15px;
  box-shadow: inset 0 0 15px #000;
}

.bar-container {
  background: #1b263b;
  height: 12px;
  border-radius: 10px;
  margin-bottom: 20px;
  overflow: hidden;
}

.bar {
  height: 100%;
  width: 0%;
  background: #4cc9f0;
  transition: 0.4s;
}

canvas { margin-top:20px; }

label {
  font-size: 13px;
  color: #a9d6e5;
}

select, input {
  width:100%;
  padding:10px;
  margin:8px 0;
  border-radius:15px;
  border:none;
  background:#1b263b;
  color:white;
}

button.calc{
  width:100%;
  padding:14px;
  border-radius:25px;
  border:none;
  background:#4cc9f0;
  color:#001d3d;
  font-weight:bold;
  font-size:16px;
  margin-top:15px;
  cursor:pointer;
}

.footer{
  text-align:center;
  font-size:11px;
  margin-top:15px;
  color:#89c2d9;
}
</style>
</head>

<body>

<div class="topmenu">
<button class="btn-sondas" onclick="mostrar('sondas')">‚ùÑÔ∏è SONDAS</button>
<button class="btn-comp" onclick="mostrar('compresor')">üí® COMPRESOR</button>
</div>

<div class="container">

<!-- ================== SONDAS PRO ================== -->
<div id="sondas" class="module active">

<div class="brand">BOTTY HVAC TOOL ‚ùÑÔ∏è</div>

<div class="display" id="display">0.00 ¬∞C</div>

<div class="bar-container">
<div class="bar" id="bar"></div>
</div>

<canvas id="grafica"></canvas>

<label>Simulaci√≥n Temperatura</label>
<input type="range" id="simTemp" min="-20" max="100" value="25" step="1">

<label>Tipo de Sonda</label>
<select id="tipo">
<option value="NTC_1000">NTC 1K</option>
<option value="NTC_10000">NTC 10K</option>
<option value="NTC_25000">NTC 25K</option>
<option value="PTC_1000">PTC 1K</option>
<option value="PTC_10000">PTC 10K</option>
<option value="PTC_25000">PTC 25K</option>
</select>

<label>Resistencia medida (Œ©)</label>
<input type="number" id="resistencia">

<label>Beta (NTC)</label>
<input type="number" id="beta" value="3435">

<button class="calc" onclick="calcular()">MEDIR</button>

<hr style="margin:20px 0; border-color:#1b263b;">

<label>Temperatura ‚Üí Calcular Œ©</label>
<input type="number" id="tempInversa">

<button class="calc" onclick="calcularInversa()">CALCULAR Œ©</button>

<div id="resultadoInverso" style="margin-top:10px;"></div>
<div id="sugerencia" style="margin-top:10px;"></div>

<div class="footer">
Zona normal 2¬∞C ‚Äì 45¬∞C
</div>

</div>

<!-- ================== COMPRESOR ================== -->
<div id="compresor" class="module">

<div class="brand" style="color:#f2c200;">BOTTY COMPRESSOR TOOL üí®</div>

<div class="display" id="displayComp">0 L/min</div>

<label>Volumen tanque (L)</label>
<input type="number" id="volumen">

<label>Presi√≥n final (bar)</label>
<input type="number" id="pFinal">

<label>Tiempo (segundos)</label>
<input type="number" id="tiempo">

<button class="calc" style="background:#f2c200;color:#000;" onclick="calcularCompresor()">CALCULAR</button>

<div id="resultadoComp" style="margin-top:10px;"></div>

</div>

</div>

<script>

// ===== CAMBIO MODULO =====
function mostrar(id){
document.getElementById("sondas").classList.remove("active");
document.getElementById("compresor").classList.remove("active");
document.getElementById(id).classList.add("active");
}

// ===== SONDAS =====
let chart;

function calcNTC(R,R0,beta){
let T0=298.15;
let tempK=1/((1/T0)+(1/beta)*Math.log(R/R0));
return tempK-273.15;
}

function calcPTC(R,R0){
let alpha=0.00385;
return (R-R0)/(R0*alpha);
}

function actualizarDisplay(tempC){
let display=document.getElementById("display");
let bar=document.getElementById("bar");

display.innerHTML=tempC.toFixed(2)+" ¬∞C";

let porcentaje=((tempC+20)/120)*100;
porcentaje=Math.max(0,Math.min(100,porcentaje));
bar.style.width=porcentaje+"%";

if(tempC<2) bar.style.background="#00b4d8";
else if(tempC<=45) bar.style.background="#4cc9f0";
else bar.style.background="#ff6b6b";
}

function generarGrafica(tipo,beta,tempActual){

let R0=parseInt(tipo.split("_")[1]);
let temps=[],resistencias=[];

for(let t=-20;t<=100;t++){
let R;
if(tipo.includes("NTC")){
let T0=298.15;
let Tk=t+273.15;
R=R0*Math.exp(beta*(1/Tk-1/T0));
}else{
let alpha=0.00385;
R=R0*(1+alpha*t);
}
temps.push(t);
resistencias.push(R);
}

if(chart) chart.destroy();

chart=new Chart(document.getElementById("grafica"),{
type:'line',
data:{
datasets:[{
data:temps.map((t,i)=>({x:t,y:resistencias[i]})),
borderColor:'#4cc9f0',
fill:false,
parsing:false
}]
},
options:{
responsive:true,
scales:{
x:{type:'linear',min:-20,max:100},
y:{}
}
}
});
}

function calcular(){

let tipo=document.getElementById("tipo").value;
let R=parseFloat(document.getElementById("resistencia").value);
let beta=parseFloat(document.getElementById("beta").value);

if(!R) return;

let R0=parseInt(tipo.split("_")[1]);
let temp=tipo.includes("NTC")?calcNTC(R,R0,beta):calcPTC(R,R0);

actualizarDisplay(temp);
generarGrafica(tipo,beta,temp);
}

function calcularInversa(){

let tipo=document.getElementById("tipo").value;
let temp=parseFloat(document.getElementById("tempInversa").value);
let beta=parseFloat(document.getElementById("beta").value);

if(isNaN(temp)) return;

let R0=parseInt(tipo.split("_")[1]);
let resistencia;

if(tipo.includes("NTC")){
let T0=298.15;
let Tk=temp+273.15;
resistencia=R0*Math.exp(beta*(1/Tk-1/T0));
}else{
let alpha=0.00385;
resistencia=R0*(1+alpha*temp);
}

document.getElementById("resultadoInverso").innerHTML=
resistencia.toFixed(2)+" Œ©";
}

document.getElementById("simTemp").addEventListener("input",function(){
let tipo=document.getElementById("tipo").value;
let beta=parseFloat(document.getElementById("beta").value);
let t=parseFloat(this.value);
actualizarDisplay(t);
generarGrafica(tipo,beta,t);
});

// ===== COMPRESOR =====
function calcularCompresor(){

let V=parseFloat(document.getElementById("volumen").value);
let P=parseFloat(document.getElementById("pFinal").value);
let tSeg=parseFloat(document.getElementById("tiempo").value);

if(!V||!P||!tSeg) return;

let tMin=tSeg/60;
let caudal=(V*P)/tMin;
let m3h=(caudal/1000)*60;
let HP=caudal/92;
let kW=HP*0.736;

document.getElementById("displayComp").innerHTML=
caudal.toFixed(0)+" L/min";

document.getElementById("resultadoComp").innerHTML=
m3h.toFixed(1)+" m¬≥/h<br>"+
kW.toFixed(2)+" kW<br>"+
HP.toFixed(1)+" CV";
}

</script>

</body>
</html>
